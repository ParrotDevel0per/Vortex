<!DOCTYPE html>
<html lang="en-US">
<head>
    <title>Player</title>
    <meta name="viewport" content="width=1920, height=1080, initial-scale=1.0">
    <link rel="apple-touch-icon" sizes="180x180" href="/static/img/favicon/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/static/img/favicon/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/static/img/favicon/favicon-16x16.png">
    <script src="/static/js/playerjs.js"></script>
    <style>
        html, body {
            background-color: black;
            height: 80vh;
        }
        .btn { 
            height: 6vh;
            width: 100%;
            display: block;
            background-color: rgb(0, 0, 0);
            border: rgb(59, 59, 59) 2px solid;
            color: azure;
            border-radius: 25px;
            margin-top: 9px;
        }
        .btn:hover {
            background-color: rgb(59, 59, 59);
            cursor: pointer;
        }
    </style>
</head>
<body>
    <div id="player" style="width:100%;height:100%"></div>
    <button style="display: none;" onclick="nextEpisode()" class="btn" id="ne">Next Episode</button>
    <button style="display: none;" onclick="nextSeason()" class="btn" id="ns">Next Season</button>
    <script>
        const xhr = new XMLHttpRequest();
        xhr.open("GET", "{{ sourcesURL }}", true);
        xhr.onload = (e) => {
        if (xhr.readyState === 4) {
            if (xhr.status === 200) {
                const data = JSON.parse(xhr.responseText);
                console.log(data);
                var player = new Playerjs({
                    id:"player",
                    file:data
                });
            } else {
                console.error(xhr.statusText);
            }
        }
        };
        xhr.onerror = (e) => {
        console.error(xhr.statusText);
        };
        xhr.send(null);
    </script>

    <script>
    var se = parseInt("{{ se }}");
    var ep = parseInt("{{ ep }}");
    var epc = parseInt("{{ epc }}");
    var sec = parseInt("{{ sec }}");
    var id = "{{ id }}";
    var ne = document.getElementById("ne");
    var ns = document.getElementById("ns");

    if (se != 0) {
        // check if this ain't last season / episode
        if (ep != epc) { ne.style.display = "block"; }
        if (se != sec) { ns.style.display = "block"; }
    }

    const nextEpisode = () => {
        location = `/play/${id}/${se}-${ep + 1}?kind=show`;
    }

    const nextSeason = () => {
        location = `/play/${id}/${se + 1}-1?kind=show`;
    }
    </script>
</body>
</html>